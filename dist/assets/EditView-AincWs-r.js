import{f as Q,z as W,A as X,u as Y,s as Z,r as E,B as $,g as ee,o as s,c as m,a as t,w as l,d as f,C as k,h as te,i as oe,y as _,p as V,q as w,b as c,T as B,j as y,e as ae,E as le,D as ne,G as se,H as re,t as pe,x as ie,I as ue,J as de,K as me,L as ye,v as ce}from"./index-CuHrO1UT.js";/* empty css                   *//* empty css               *//* empty css                *//* empty css                 *//* empty css                  *//* empty css                     *//* empty css                           */import{u as Te}from"./armyTypes-DYqyAicj.js";import{u as fe,U as _e}from"./unitTypes-bP-PZcfW.js";import{u as ge}from"./troopTypes-koCoEWjd.js";import{u as be}from"./compositionTypes-fR5ialL-.js";import"./timestamp_pb-B3iL3wgR.js";import"./types_pb-D0t3hVCi.js";const Ie={class:"unit-type-edit"},ve=c("br",null,null,-1),Me=c("br",null,null,-1),Fe=Q({__name:"EditView",setup(Ve){const S=W(),A=X(),p=Y(),h=Te(),U=fe(),D=ge(),R=be(),{loading:g}=Z(p),b=E([]),I=E([]),F=E([]),e=$({name:"",gameId:"",armyTypeId:"",armyTypeName:"",troopTypeId:"",compositionTypeId:"",parentUnitTypeId:"",pointsPerModel:0,minModels:1,maxModels:1,stats:[]});async function C(){p.loading=!0;const[r,o]=await U.getUnitType(S.params.id);if(o){y.error(o);return}const n=r,[x,T]=await h.getArmyType(n.armyTypeId);if(T){y.error(T);return}const u=x;e.name=n.name,e.gameId=n.gameId,e.armyTypeId=n.armyTypeId,e.armyTypeName=u.name,e.troopTypeId=n.troopTypeId,e.compositionTypeId=n.compositionTypeId,e.pointsPerModel=Number(n.pointsPerModel),e.minModels=Number(n.minModels),e.maxModels=Number(n.maxModels),e.stats=n.statistics,p.loading=!1}async function L(){p.loading=!0;const[r,,o]=await D.getTroopTypes(e.gameId,1e3,0);if(o){y.error(o);return}b.value=r,b.value.length>0&&(e.troopTypeId=b.value[0].id),p.loading=!1}async function j(){p.loading=!0;const[r,,o]=await R.getCompositionTypes(e.gameId,1e3,0);if(o){y.error(o);return}I.value=r,I.value.length>0&&(e.troopTypeId=I.value[0].id),p.loading=!1}async function q(){p.loading=!0;const[r,o]=await U.getUnitTypeNamesFromArmyTypeId(e.armyTypeId);if(o){y.error(o);return}F.value=r,p.loading=!1}async function H(){g.value=!0,await C(),g.value=!1}async function z(){g.value=!0;const r=await U.updateUnitType(new _e({id:S.params.id,name:e.name,pointsPerModel:BigInt(e.pointsPerModel),minModels:BigInt(e.minModels),maxModels:BigInt(e.maxModels),troopTypeId:e.troopTypeId,compositionTypeId:e.compositionTypeId,statistics:e.stats}));if(r){y.error(r);return}y.success("Successfully updated unit type"),A.push("/unit-types")}return ee(async()=>{await C(),await L(),await j(),await q()}),(r,o)=>{const n=ae,x=le,T=ne,u=se,i=re,v=pe,N=ie,P=ue,G=de,J=me,K=ye,O=ce;return s(),m("div",Ie,[t(x,{separator:"/"},{default:l(()=>[t(n,{to:{path:"/"}},{default:l(()=>[f("Homepage")]),_:1}),t(n,{to:{path:"/user-armies"}},{default:l(()=>[f("User Armies")]),_:1}),t(n,null,{default:l(()=>[f("Edit "+k(e.name),1)]),_:1})]),_:1}),ve,Me,t(K,{class:"row-bg",justify:"space-between"},{default:l(()=>[t(T,{span:4}),t(T,{span:10},{default:l(()=>[t(J,null,{default:l(()=>[te((s(),_(G,{model:e,"label-width":"auto",style:{"max-height":"600px"}},{default:l(()=>[t(i,{label:"Army Name"},{default:l(()=>[t(u,{modelValue:e.name,"onUpdate:modelValue":o[0]||(o[0]=a=>e.name=a)},null,8,["modelValue"])]),_:1}),t(i,{label:"Army Type"},{default:l(()=>[t(u,{modelValue:e.armyTypeName,"onUpdate:modelValue":o[1]||(o[1]=a=>e.armyTypeName=a),disabled:""},null,8,["modelValue"])]),_:1}),t(i,{label:"Troop Type"},{default:l(()=>[t(N,{modelValue:e.troopTypeId,"onUpdate:modelValue":o[2]||(o[2]=a=>e.troopTypeId=a),placeholder:"please select a troop type"},{default:l(()=>[(s(),_(v,{key:"",label:"-- Please select a Troop Tyoe --",value:""})),(s(!0),m(V,null,w(b.value,(a,d)=>(s(),_(v,{key:d,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(i,{label:"Composition Type"},{default:l(()=>[t(N,{modelValue:e.compositionTypeId,"onUpdate:modelValue":o[3]||(o[3]=a=>e.compositionTypeId=a),placeholder:"please select a composition type"},{default:l(()=>[(s(),_(v,{key:"",label:"-- Please select a Composition Tyoe --",value:""})),(s(!0),m(V,null,w(I.value,(a,d)=>(s(),_(v,{key:d,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(i,{label:"Points Per Model"},{default:l(()=>[t(u,{modelValue:e.pointsPerModel,"onUpdate:modelValue":o[4]||(o[4]=a=>e.pointsPerModel=a),type:"number"},null,8,["modelValue"])]),_:1}),t(i,{label:"Min Models"},{default:l(()=>[t(u,{modelValue:e.minModels,"onUpdate:modelValue":o[5]||(o[5]=a=>e.minModels=a),type:"number",min:"1"},null,8,["modelValue"])]),_:1}),t(i,{label:"Max Models"},{default:l(()=>[t(u,{modelValue:e.maxModels,"onUpdate:modelValue":o[6]||(o[6]=a=>e.maxModels=a),type:"number",min:"1"},null,8,["modelValue"])]),_:1}),t(i,{label:"Statistics"},{default:l(()=>[c("table",null,[c("thead",null,[c("tr",null,[(s(!0),m(V,null,w(e.stats,(a,d)=>{var M;return s(),m("th",{key:d},k((M=a.statistic)==null?void 0:M.display),1)}),128))])]),c("tbody",null,[c("tr",null,[(s(!0),m(V,null,w(e.stats,(a,d)=>(s(),m("th",{key:d},[t(u,{modelValue:a.value,"onUpdate:modelValue":M=>a.value=M},null,8,["modelValue","onUpdate:modelValue"])]))),128))])])])]),_:1}),t(i,null,{default:l(()=>[t(P,{type:"primary",onClick:B(z,["prevent"])},{default:l(()=>[f("Save")]),_:1}),t(P,{type:"warning",onClick:B(H,["prevent"])},{default:l(()=>[f("Reset")]),_:1})]),_:1})]),_:1},8,["model"])),[[O,oe(g)]])]),_:1})]),_:1}),t(T,{span:4})]),_:1})])}}});export{Fe as default};
