import{f as W,C as Q,D as X,u as Y,s as Z,g as E,G as $,k as ee,o as s,c as m,a as t,w as l,d as f,H as P,m as te,l as oe,B as _,j as V,y as w,b as c,W as B,n as y,e as ae,E as le,I as ne,J as se,K as re,z as pe,A as ie,L as ue,M as de,N as me,O as ye,v as ce}from"./index-Bo4L7-t_.js";/* empty css                   *//* empty css               *//* empty css                *//* empty css                 *//* empty css                  *//* empty css                     *//* empty css                           */import{u as Te}from"./armyTypes-V-LEmafu.js";import{u as fe,U as _e}from"./unitTypes-sI2a_SDX.js";import{u as ge}from"./troopTypes-D7zjMfaR.js";import{u as be}from"./compositionTypes-D0V6NQbd.js";import"./timestamp_pb-CFeAd6Js.js";import"./types_pb-DoulQPha.js";const Ie={class:"unit-type-edit"},Me=c("br",null,null,-1),ve=c("br",null,null,-1),Fe=W({__name:"EditView",setup(Ve){const S=Q(),A=X(),p=Y(),h=Te(),U=fe(),D=ge(),R=be(),{loading:g}=Z(p),b=E([]),I=E([]),F=E([]),e=$({name:"",gameId:"",armyTypeId:"",armyTypeName:"",troopTypeId:"",compositionTypeId:"",parentUnitTypeId:"",pointsPerModel:0,minModels:1,maxModels:1,stats:[]});async function N(){p.loading=!0;const[r,o]=await U.getUnitType(S.params.id);if(o){y.error(o);return}const n=r,[x,T]=await h.getArmyType(n.armyTypeId);if(T){y.error(T);return}const u=x;e.name=n.name,e.gameId=n.gameId,e.armyTypeId=n.armyTypeId,e.armyTypeName=u.name,e.troopTypeId=n.troopTypeId,e.compositionTypeId=n.compositionTypeId,e.pointsPerModel=Number(n.pointsPerModel),e.minModels=Number(n.minModels),e.maxModels=Number(n.maxModels),e.stats=n.statistics,p.loading=!1}async function L(){p.loading=!0;const[r,,o]=await D.getTroopTypes(e.gameId,1e3,0);if(o){y.error(o);return}b.value=r,b.value.length>0&&(e.troopTypeId=b.value[0].id),p.loading=!1}async function j(){p.loading=!0;const[r,,o]=await R.getCompositionTypes(e.gameId,1e3,0);if(o){y.error(o);return}I.value=r,I.value.length>0&&(e.troopTypeId=I.value[0].id),p.loading=!1}async function H(){p.loading=!0;const[r,o]=await U.getUnitTypeNamesFromArmyTypeId(e.armyTypeId);if(o){y.error(o);return}F.value=r,p.loading=!1}async function O(){g.value=!0,await N(),g.value=!1}async function q(){g.value=!0;const r=await U.updateUnitType(new _e({id:S.params.id,name:e.name,pointsPerModel:BigInt(e.pointsPerModel),minModels:BigInt(e.minModels),maxModels:BigInt(e.maxModels),troopTypeId:e.troopTypeId,compositionTypeId:e.compositionTypeId,statistics:e.stats}));if(r){y.error(r);return}y.success("Successfully updated unit type"),A.push("/unit-types")}return ee(async()=>{await N(),await L(),await j(),await H()}),(r,o)=>{const n=ae,x=le,T=ne,u=se,i=re,M=pe,k=ie,C=ue,z=de,G=me,J=ye,K=ce;return s(),m("div",Ie,[t(x,{separator:"/"},{default:l(()=>[t(n,{to:{path:"/"}},{default:l(()=>[f("Homepage")]),_:1}),t(n,{to:{path:"/user-armies"}},{default:l(()=>[f("User Armies")]),_:1}),t(n,null,{default:l(()=>[f("Edit "+P(e.name),1)]),_:1})]),_:1}),Me,ve,t(J,{class:"row-bg",justify:"space-between"},{default:l(()=>[t(T,{span:4}),t(T,{span:10},{default:l(()=>[t(G,null,{default:l(()=>[te((s(),_(z,{model:e,"label-width":"auto",style:{"max-height":"600px"}},{default:l(()=>[t(i,{label:"Army Name"},{default:l(()=>[t(u,{modelValue:e.name,"onUpdate:modelValue":o[0]||(o[0]=a=>e.name=a)},null,8,["modelValue"])]),_:1}),t(i,{label:"Army Type"},{default:l(()=>[t(u,{modelValue:e.armyTypeName,"onUpdate:modelValue":o[1]||(o[1]=a=>e.armyTypeName=a),disabled:""},null,8,["modelValue"])]),_:1}),t(i,{label:"Troop Type"},{default:l(()=>[t(k,{modelValue:e.troopTypeId,"onUpdate:modelValue":o[2]||(o[2]=a=>e.troopTypeId=a),placeholder:"please select a troop type"},{default:l(()=>[(s(),_(M,{key:"",label:"-- Please select a Troop Tyoe --",value:""})),(s(!0),m(V,null,w(b.value,(a,d)=>(s(),_(M,{key:d,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(i,{label:"Composition Type"},{default:l(()=>[t(k,{modelValue:e.compositionTypeId,"onUpdate:modelValue":o[3]||(o[3]=a=>e.compositionTypeId=a),placeholder:"please select a composition type"},{default:l(()=>[(s(),_(M,{key:"",label:"-- Please select a Composition Tyoe --",value:""})),(s(!0),m(V,null,w(I.value,(a,d)=>(s(),_(M,{key:d,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(i,{label:"Points Per Model"},{default:l(()=>[t(u,{modelValue:e.pointsPerModel,"onUpdate:modelValue":o[4]||(o[4]=a=>e.pointsPerModel=a),type:"number"},null,8,["modelValue"])]),_:1}),t(i,{label:"Min Models"},{default:l(()=>[t(u,{modelValue:e.minModels,"onUpdate:modelValue":o[5]||(o[5]=a=>e.minModels=a),type:"number",min:"1"},null,8,["modelValue"])]),_:1}),t(i,{label:"Max Models"},{default:l(()=>[t(u,{modelValue:e.maxModels,"onUpdate:modelValue":o[6]||(o[6]=a=>e.maxModels=a),type:"number",min:"1"},null,8,["modelValue"])]),_:1}),t(i,{label:"Statistics"},{default:l(()=>[c("table",null,[c("thead",null,[c("tr",null,[(s(!0),m(V,null,w(e.stats,(a,d)=>{var v;return s(),m("th",{key:d},P((v=a.statistic)==null?void 0:v.display),1)}),128))])]),c("tbody",null,[c("tr",null,[(s(!0),m(V,null,w(e.stats,(a,d)=>(s(),m("th",{key:d},[t(u,{modelValue:a.value,"onUpdate:modelValue":v=>a.value=v},null,8,["modelValue","onUpdate:modelValue"])]))),128))])])])]),_:1}),t(i,null,{default:l(()=>[t(C,{type:"primary",onClick:B(q,["prevent"])},{default:l(()=>[f("Save")]),_:1}),t(C,{type:"warning",onClick:B(O,["prevent"])},{default:l(()=>[f("Reset")]),_:1})]),_:1})]),_:1},8,["model"])),[[K,oe(g)]])]),_:1})]),_:1}),t(T,{span:4})]),_:1})])}}});export{Fe as default};
